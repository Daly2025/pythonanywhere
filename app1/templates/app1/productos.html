{% extends 'app1/base.html' %}
{% load static %}

{% block content %}
    <main>
        <section class="productos-page">
            <h2>Nuestra Selecci√≥n de Mieles</h2>
            <div class="productos-grid">
                <div class="producto">
                    <img src="{% static 'app1/img/flor.jpeg' %}" alt="Miel de flores">
                    <h3>Miel de Flores</h3>
                    <p>Un sabor suave y arom√°tico.</p>
                    <p class="precio">10.99‚Ç¨</p>
                    <div class="producto-acciones">
                        <input type="number" min="1" value="1" class="cantidad-input">
                        <button class="btn-carrito" onclick="agregarAlCarrito('Miel de Flores', 10.99, this)">
                            A√±adir al Carrito
                        </button>
                    </div>
                </div>
                <div class="producto">
                    <img src="{% static 'app1/img/miel.jpeg' %}" alt="Miel de bosque">
                    <h3>Miel de Bosque</h3>
                    <p>Rica en antioxidantes, ideal para la salud.</p>
                    <p class="precio">12.99‚Ç¨</p>
                    <div class="producto-acciones">
                        <input type="number" min="1" value="1" class="cantidad-input">
                        <button class="btn-carrito" onclick="agregarAlCarrito('Miel de Bosque', 12.99, this)">
                            A√±adir al Carrito
                        </button>
                    </div>
                </div>
                <div class="producto">
                    <img src="{% static 'app1/img/fresca.jpeg' %}" alt="Fresca">
                    <h3>Miel Fresca</h3>
                    <p>Miel pura y natural reci√©n recolectada.</p>
                    <p class="precio">11.99‚Ç¨</p>
                    <div class="producto-acciones">
                        <input type="number" min="1" value="1" class="cantidad-input">
                        <button class="btn-carrito" onclick="agregarAlCarrito('Miel Fresca', 11.99, this)">
                            A√±adir al Carrito
                        </button>
                    </div>
                </div>
                <div class="producto">
                    <img src="{% static 'app1/img/jaleareal.jpeg' %}" alt="Jalea Real">
                    <h3>Jalea Real</h3>
                    <p>El tesoro de la colmena, rica en nutrientes.</p>
                    <p class="precio">14.99‚Ç¨</p>
                    <div class="producto-acciones">
                        <input type="number" min="1" value="1" class="cantidad-input">
                        <button class="btn-carrito" onclick="agregarAlCarrito('Jalea Real', 14.99, this)">
                            A√±adir al Carrito
                        </button>
                    </div>
                </div>
                <div class="producto">
                    <img src="{% static 'app1/img/melaza.jpeg' %}" alt="Melaza">
                    <h3>Melaza</h3>
                    <p>Dulzura natural concentrada.</p>
                    <p class="precio">9.99‚Ç¨</p>
                    <div class="producto-acciones">
                        <input type="number" min="1" value="1" class="cantidad-input">
                        <button class="btn-carrito" onclick="agregarAlCarrito('Melaza', 9.99, this)">
                            A√±adir al Carrito
                        </button>
                    </div>
                </div>
                <div class="producto">
                    <img src="{% static 'app1/img/miel de romero.jpeg' %}" alt="Miel de Romero">
                    <h3>Miel de Romero</h3>
                    <p>Delicado sabor arom√°tico a hierbas.</p>
                    <p class="precio">13.99‚Ç¨</p>
                    <div class="producto-acciones">
                        <input type="number" min="1" value="1" class="cantidad-input">
                        <button class="btn-carrito" onclick="agregarAlCarrito('Miel de Romero', 13.99, this)">
                            A√±adir al Carrito
                        </button>
                    </div>
                </div>
                <div class="producto">
                    <img src="{% static 'app1/img/propoleo.jpeg' %}" alt="Prop√≥leo">
                    <h3>Prop√≥leo</h3>
                    <p>Poderoso antibi√≥tico natural.</p>
                    <p class="precio">15.99‚Ç¨</p>
                    <div class="producto-acciones">
                        <input type="number" min="1" value="1" class="cantidad-input">
                        <button class="btn-carrito" onclick="agregarAlCarrito('Prop√≥leo', 15.99, this)">
                            A√±adir al Carrito
                        </button>
                    </div>
                </div>
                <div class="producto">
                    <img src="{% static 'app1/img/tarritos.jpeg' %}" alt="Tarritos">
                    <h3>Tarritos de Miel</h3>
                    <p>Formato peque√±o, ideal para regalo.</p>
                    <p class="precio">8.99‚Ç¨</p>
                    <div class="producto-acciones">
                        <input type="number" min="1" value="1" class="cantidad-input">
                        <button class="btn-carrito" onclick="agregarAlCarrito('Tarritos de Miel', 8.99, this)">
                            A√±adir al Carrito
                        </button>
                    </div>
                </div>
                <div class="producto">
                    <img src="{% static 'app1/img/mielantigoteo.jpeg' %}" alt="Miel Antigoteo">
                    <h3>Miel Antigoteo</h3>
                    <p>Pr√°ctica y limpia de usar.</p>
                    <p class="precio">16.99‚Ç¨</p>
                    <div class="producto-acciones">
                        <input type="number" min="1" value="1" class="cantidad-input">
                        <button class="btn-carrito" onclick="agregarAlCarrito('Miel Antigoteo', 16.99, this)">
                            A√±adir al Carrito
                        </button>
                    </div>
                </div>
                <div class="producto">
                    <img src="{% static 'app1/img/mieldeca√±a.jpeg' %}" alt="Miel de Ca√±a">
                    <h3>Miel de Ca√±a</h3>
                    <p>Sabor intenso y natural.</p>
                    <p class="precio">17.99‚Ç¨</p>
                    <div class="producto-acciones">
                        <input type="number" min="1" value="1" class="cantidad-input">
                        <button class="btn-carrito" onclick="agregarAlCarrito('Miel de Ca√±a', 17.99, this)">
                            A√±adir al Carrito
                        </button>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Icono del carrito flotante -->
    <div class="carrito-icon" onclick="irAlCarrito()">
        üõí <span id="carrito-contador">0</span>
    </div>

    <!-- Scripts para el carrito -->
    <script>
        function agregarAlCarrito(nombre, precio, boton) {
            const cantidad = parseInt(boton.parentElement.querySelector('.cantidad-input').value);
            let carrito = JSON.parse(localStorage.getItem('carrito')) || [];
            
            // Verificar si el producto ya est√° en el carrito
            const productoExistente = carrito.findIndex(item => item.nombre === nombre);
            
            if (productoExistente !== -1) {
                carrito[productoExistente].cantidad += cantidad;
            } else {
                carrito.push({
                    nombre: nombre,
                    precio: precio,
                    cantidad: cantidad
                });
            }
            
            localStorage.setItem('carrito', JSON.stringify(carrito));
            actualizarContadorCarrito();
            
            // Mostrar mensaje de confirmaci√≥n
            alert('¬°Producto a√±adido al carrito!');
        }

        function actualizarContadorCarrito() {
            const carrito = JSON.parse(localStorage.getItem('carrito')) || [];
            const totalItems = carrito.reduce((total, item) => total + item.cantidad, 0);
            document.getElementById('carrito-contador').textContent = totalItems;
        }

        function irAlCarrito() {
            window.location.href = "{% url 'carrito' %}";
        }

        // Actualizar contador al cargar la p√°gina
        document.addEventListener('DOMContentLoaded', actualizarContadorCarrito);
    </script>
{% endblock %}